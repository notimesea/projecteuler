In[74]:= 5*((Exp[x] - Exp[-x])/2 + 1)^4*((Exp[x] + Exp[-x])/2)^6 + 
 4*((Exp[x] - Exp[-x])/2 + 1)^5 *((Exp[x] - Exp[-x])/
    2)*((Exp[x] + Exp[-x])/2)^4

Out[74]= 5/64 (E^-x + E^x)^6 (1 + 1/2 (-E^-x + E^x))^4 + 
 1/8 (-E^-x + E^x) (E^-x + E^x)^4 (1 + 1/2 (-E^-x + E^x))^5

In[75]:= Simplify[%]

Out[75]= (E^(-10 x) (-1 + 2 E^x + 2 E^(3 x) + E^(4 x))^4 (9 - 8 E^x + 
   2 E^(2 x) + 8 E^(3 x) + 9 E^(4 x)))/1024

In[76]:= Expand[%]

Out[76]= 23/256 + (9 E^(-10 x))/1024 - (5 E^(-9 x))/64 + (
 141 E^(-8 x))/512 - (35 E^(-7 x))/64 + (853 E^(-6 x))/1024 - (
 17 E^(-5 x))/16 + (119 E^(-4 x))/128 - (11 E^(-3 x))/16 + (
 209 E^(-2 x))/512 - (3 E^-x)/32 + (3 E^x)/32 + (209 E^(2 x))/512 + (
 11 E^(3 x))/16 + (119 E^(4 x))/128 + (17 E^(5 x))/16 + (
 853 E^(6 x))/1024 + (35 E^(7 x))/64 + (141 E^(8 x))/512 + (
 5 E^(9 x))/64 + (9 E^(10 x))/1024

In[126]:= 
g[x_] := 23/256 + (9 E^(-10 x))/1024 - (5 E^(-9 x))/64 + (
  141 E^(-8 x))/512 - (35 E^(-7 x))/64 + (853 E^(-6 x))/1024 - (
  17 E^(-5 x))/16 + (119 E^(-4 x))/128 - (11 E^(-3 x))/16 + (
  209 E^(-2 x))/512 - (3 E^-x)/32 + (3 E^x)/32 + (209 E^(2 x))/512 + (
  11 E^(3 x))/16 + (119 E^(4 x))/128 + (17 E^(5 x))/16 + (
  853 E^(6 x))/1024 + (35 E^(7 x))/64 + (141 E^(8 x))/512 + (
  5 E^(9 x))/64 + (9 E^(10 x))/1024
Expand[g[x], Modulus -> 1000000123]

Out[127]= E^(-10 x) (426757865 + 984375121 E^x + 705078212 E^(2 x) + 
   890625109 E^(3 x) + 891601673 E^(4 x) + 187500022 E^(5 x) + 
   585937573 E^(6 x) + 62500007 E^(7 x) + 931640740 E^(8 x) + 
   781250096 E^(9 x) + 917968863 E^(10 x) + 218750027 E^(11 x) + 
   931640740 E^(12 x) + 937500116 E^(13 x) + 585937573 E^(14 x) + 
   812500101 E^(15 x) + 891601673 E^(16 x) + 109375014 E^(17 x) + 
   705078212 E^(18 x) + 15625002 E^(19 x) + 426757865 E^(20 x))

In[129]:= 
y[x_] := E^(-10 x) (426757865 + 984375121 E^x + 705078212 E^(2 x) + 
    890625109 E^(3 x) + 891601673 E^(4 x) + 187500022 E^(5 x) + 
    585937573 E^(6 x) + 62500007 E^(7 x) + 931640740 E^(8 x) + 
    781250096 E^(9 x) + 917968863 E^(10 x) + 218750027 E^(11 x) + 
    931640740 E^(12 x) + 937500116 E^(13 x) + 585937573 E^(14 x) + 
    812500101 E^(15 x) + 891601673 E^(16 x) + 109375014 E^(17 x) + 
    705078212 E^(18 x) + 15625002 E^(19 x) + 426757865 E^(20 x))



In[139]:= y[x]

Out[139]= E^(-10 x) (426757865 + 984375121 E^x + 705078212 E^(2 x) + 
   890625109 E^(3 x) + 891601673 E^(4 x) + 187500022 E^(5 x) + 
   585937573 E^(6 x) + 62500007 E^(7 x) + 931640740 E^(8 x) + 
   781250096 E^(9 x) + 917968863 E^(10 x) + 218750027 E^(11 x) + 
   931640740 E^(12 x) + 937500116 E^(13 x) + 585937573 E^(14 x) + 
   812500101 E^(15 x) + 891601673 E^(16 x) + 109375014 E^(17 x) + 
   705078212 E^(18 x) + 15625002 E^(19 x) + 426757865 E^(20 x))

In[141]:= 
ee[x_] := 
 917968863 + 426757865 E^(-10 x) + 984375121 E^(-9 x) + 
  705078212 E^(-8 x) + 890625109 E^(-7 x) + 891601673 E^(-6 x) + 
  187500022 E^(-5 x) + 585937573 E^(-4 x) + 62500007 E^(-3 x) + 
  931640740 E^(-2 x) + 781250096 E^-x + 218750027 E^x + 
  931640740 E^(2 x) + 937500116 E^(3 x) + 585937573 E^(4 x) + 
  812500101 E^(5 x) + 891601673 E^(6 x) + 109375014 E^(7 x) + 
  705078212 E^(8 x) + 15625002 E^(9 x) + 426757865 E^(10 x)

In[131]:= Expand[y[x]]

Out[131]= 917968863 + 426757865 E^(-10 x) + 984375121 E^(-9 x) + 
 705078212 E^(-8 x) + 890625109 E^(-7 x) + 891601673 E^(-6 x) + 
 187500022 E^(-5 x) + 585937573 E^(-4 x) + 62500007 E^(-3 x) + 
 931640740 E^(-2 x) + 781250096 E^-x + 218750027 E^x + 
 931640740 E^(2 x) + 937500116 E^(3 x) + 585937573 E^(4 x) + 
 812500101 E^(5 x) + 891601673 E^(6 x) + 109375014 E^(7 x) + 
 705078212 E^(8 x) + 15625002 E^(9 x) + 426757865 E^(10 x)

In[149]:= 
ans[k_] := 
 Sum[i!*SeriesCoefficient[ee[x], {x, 0, i}], {i, 0, k}, 
  Assumptions -> k > 0]

In[150]:= FullSimplify[ans[k]]

Out[150]= 2871375339769/9240 + 390625048 (-1)^k + 
 232910185 2^(3 + k) + 232910185/3 (-1)^k 2^(3 + k) + 
 176269553/7 2^(5 + 3 k) + 176269553/9 (-1)^k 2^(5 + 3 k) + 
 468750058 3^(1 + k) + 62500007/4 (-1)^k 3^(1 + k) + 
 2604167/4 3^(3 + 2 k) + (585937573 4^(1 + k))/3 + 
 585937573/5 (-1)^k 4^(1 + k) + (812500101 5^(1 + k))/4 + 
 93750011/3 (-1)^k 5^(1 + k) + 85351573/9 2^(1 + k) 5^(2 + k) + 
 85351573/11 (-1)^k 2^(1 + k) 5^(2 + k) + (891601673 6^(1 + k))/5 + 
 891601673/7 (-1)^k 6^(1 + k) + 890625109/8 (-1)^k 7^(1 + k) + 
 2604167 7^(2 + k) + 984375121/10 (-1)^k 9^(1 + k) + 218750027 k

Expand[%, Modulus -> 1000000123]

Out[151]= 202205110 + 654296955 (-7)^k + 621372845 (-6)^k + 
 822916767 (-5)^k + 296875036 (-3)^k + 954427201 (-2)^k + 
 390625048 (-1)^k + 863281357 2^k + 447916723 2^(2 k) + 
 668750083 (-1)^k 2^(2 k) + 233354077 (-5)^k 2^(2 + k) + 
 260044675 2^(1 + 3 k) + 424479219 (-1)^k 2^(1 + 3 k) + 
 406250051 3^k + 267578158 3^(2 k) + 195312524 (-1)^k 3^(1 + 2 k) + 
 265625034 5^k + 62988289 2^(2 + k) 5^k + 869921983 6^k + 
 2604167 7^(2 + k) + 218750027 k

In[155]:= Mod[
 202205110 + 654296955 (-7)^k + 621372845 (-6)^k + 822916767 (-5)^k + 
  296875036 (-3)^k + 954427201 (-2)^k + 390625048 (-1)^k + 
  863281357 2^k + 447916723 2^(2 k) + 668750083 (-1)^k 2^(2 k) + 
  233354077 (-5)^k 2^(2 + k) + 260044675 2^(1 + 3 k) + 
  424479219 (-1)^k 2^(1 + 3 k) + 406250051 3^k + 267578158 3^(2 k) + 
  195312524 (-1)^k 3^(1 + 2 k) + 265625034 5^k + 
  62988289 2^(2 + k) 5^k + 869921983 6^k + 2604167 7^(2 + k) + 
  218750027 k, 1000000123]

Out[155]= Mod[
 202205110 + 654296955 (-7)^k + 621372845 (-6)^k + 822916767 (-5)^k + 
  296875036 (-3)^k + 954427201 (-2)^k + 390625048 (-1)^k + 
  863281357 2^k + 447916723 2^(2 k) + 668750083 (-1)^k 2^(2 k) + 
  233354077 (-5)^k 2^(2 + k) + 260044675 2^(1 + 3 k) + 
  424479219 (-1)^k 2^(1 + 3 k) + 406250051 3^k + 267578158 3^(2 k) + 
  195312524 (-1)^k 3^(1 + 2 k) + 265625034 5^k + 
  62988289 2^(2 + k) 5^k + 869921983 6^k + 2604167 7^(2 + k) + 
  218750027 k, 1000000123]

In[156]:= Simplify[%]

Out[156]= Mod[
 202205110 + 654296955 (-7)^k + 621372845 (-6)^k + 822916767 (-5)^k + 
  668750083 (-4)^k + 296875036 (-3)^k + 954427201 (-2)^k + 
  390625048 (-1)^k + 863281357 2^k + 233354077 (-5)^k 2^(2 + k) + 
  260044675 2^(1 + 3 k) + 424479219 (-1)^k 2^(1 + 3 k) + 
  406250051 3^k + 195312524 (-1)^k 3^(1 + 2 k) + 447916723 4^k + 
  265625034 5^k + 62988289 2^(2 + k) 5^k + 869921983 6^k + 
  2604167 7^(2 + k) + 267578158 9^k + 218750027 k, 1000000123]

In[158]:= 
202205110 + 654296955 (-7)^k + 621372845 (-6)^k + 822916767 (-5)^k + 
  296875036 (-3)^k + 954427201 (-2)^k + 390625048 (-1)^k + 
  863281357 2^k + 447916723 2^(2 k) + 668750083 (-1)^k 2^(2 k) + 
  233354077 (-5)^k 2^(2 + k) + 260044675 2^(1 + 3 k) + 
  424479219 (-1)^k 2^(1 + 3 k) + 406250051 3^k + 267578158 3^(2 k) + 
  195312524 (-1)^k 3^(1 + 2 k) + 265625034 5^k + 
  62988289 2^(2 + k) 5^k + 869921983 6^k + 2604167 7^(2 + k) + 
  218750027 k /. p_^q_ -> PowerMod[p, q, 1000000123]

Out[158]= 202205110 + 218750027 k + 
 654296955 PowerMod[-7, k, 1000000123] + 
 621372845 PowerMod[-6, k, 1000000123] + 
 822916767 PowerMod[-5, k, 1000000123] + 
 296875036 PowerMod[-3, k, 1000000123] + 
 954427201 PowerMod[-2, k, 1000000123] + 
 390625048 PowerMod[-1, k, 1000000123] + 
 863281357 PowerMod[2, k, 1000000123] + 
 447916723 PowerMod[2, 2 k, 1000000123] + 
 668750083 PowerMod[-1, k, 1000000123] PowerMod[2, 2 k, 1000000123] + 
 233354077 PowerMod[-5, k, 1000000123] PowerMod[2, 2 + k, 
   1000000123] + 260044675 PowerMod[2, 1 + 3 k, 1000000123] + 
 424479219 PowerMod[-1, k, 1000000123] PowerMod[2, 1 + 3 k, 
   1000000123] + 406250051 PowerMod[3, k, 1000000123] + 
 267578158 PowerMod[3, 2 k, 1000000123] + 
 195312524 PowerMod[-1, k, 1000000123] PowerMod[3, 1 + 2 k, 
   1000000123] + 265625034 PowerMod[5, k, 1000000123] + 
 62988289 PowerMod[2, 2 + k, 1000000123] PowerMod[5, k, 1000000123] + 
 869921983 PowerMod[6, k, 1000000123] + 
 2604167 PowerMod[7, 2 + k, 1000000123]

In[159]:= 
ww[k_] := 
 202205110 + 218750027 k + 654296955 PowerMod[-7, k, 1000000123] + 
  621372845 PowerMod[-6, k, 1000000123] + 
  822916767 PowerMod[-5, k, 1000000123] + 
  296875036 PowerMod[-3, k, 1000000123] + 
  954427201 PowerMod[-2, k, 1000000123] + 
  390625048 PowerMod[-1, k, 1000000123] + 
  863281357 PowerMod[2, k, 1000000123] + 
  447916723 PowerMod[2, 2 k, 1000000123] + 
  668750083 PowerMod[-1, k, 1000000123] PowerMod[2, 2 k, 
    1000000123] + 
  233354077 PowerMod[-5, k, 1000000123] PowerMod[2, 2 + k, 
    1000000123] + 260044675 PowerMod[2, 1 + 3 k, 1000000123] + 
  424479219 PowerMod[-1, k, 1000000123] PowerMod[2, 1 + 3 k, 
    1000000123] + 406250051 PowerMod[3, k, 1000000123] + 
  267578158 PowerMod[3, 2 k, 1000000123] + 
  195312524 PowerMod[-1, k, 1000000123] PowerMod[3, 1 + 2 k, 
    1000000123] + 265625034 PowerMod[5, k, 1000000123] + 
  62988289 PowerMod[2, 2 + k, 1000000123] PowerMod[5, k, 
    1000000123] + 869921983 PowerMod[6, k, 1000000123] + 
  2604167 PowerMod[7, 2 + k, 1000000123]

In[160]:= Sum[ww[2^i - 1], {i, 1, 39}]

Out[160]= 22771211807811547004437629032

In[161]:= Mod[%, 1000000123]

Out[161]= 238413705



